%*****基于快速傅里叶变化的低通滤波程序***********%
作者：毛艳军
单位：大连理工大学深海研究中心
时间：2016年7月21日
%*************程序概述*************************************%
本程序是基于基于快速傅里叶变化的低通滤波程序，其中滤波器选择为FIRE的切比雪夫I型滤波器，和IIR的汉宁窗，以及汉明窗。
同时附带了一下几种功能：
1.批处理和单个文件处理功能；
2.绘制时程曲线和频谱，以及能量谱曲线；
3.对能量谱积分对比滤波前后能量变化，通过error(i)作为评价指标；
4.可进行信噪比snr和均方误差rems的计算；
5.寻找峰值和对比滤波前后峰值误差errorPeak;
6.自动命名和保存数据结果；
7.寻找并标记出峰值，1/2峰值，1/5峰值位置；
下面就相关程序功能，调用，返回情况，按照程序调用顺序介绍
%*****************峰值查找函数**********************************%
[pksOriginal,locs]=findpeaks(x,'minpeakdistance',24000,'MINPEAKHEIGHT',0.0);
输入x为时程数据序列，以及先关控制参数字典
输出：pksOriginal:为峰值幅值，locs为幅值所在位置地址
'minpeakdistance'：控制最下带宽
'MINPEAKHEIGHT'：最小峰值高度
%******************绘制频谱，以及能量谱曲线*********************************%
[area,h,y_f]=hua_fft(x,fs);
输入x为时程数据序列，fs为采样频率；
返回值：area为能量谱面积，期中能量谱为幅值谱的平方；h为傅里叶变化后的幅值；y_f为T变换后对应的频率的序列
%**********************滤波器程序*******************************************%
y=lowp(x,f1,f3,rp,rs,fs);%f1=2.5,f3=3.0,rp=0.1,rs=2.0
为切比雪夫I型滤波器，输入参数通带截止频率f1,阻带截至频率f2,rp通带允许波动系数，rs阻带最低消减幅度系数
返回值y为滤波后的时程序列数据
y=hamingFirlowp(x,f1,f3,fs);
为hann窗或者haming窗，使用时只需更改程序中的主函数hann(),haming().其他参数同上；
%***********************需找并标记1/2峰值，1/5峰值*****************************%
[c,d]=FindHalfPeak(pksFilter,t,locsFilter);
pksFilter：为已查询峰值序列,t：基于采样频率构建的离散时间序列,locsFilter：峰值位置地址；
返回值c:为1/2峰值所在locsFilter位置地址中的编号；d:为1/5峰值所在locsFilter位置地址中的编号；
%****************************snr()信噪比和均方误差的求取************************************************%
[SNR,RMSE]=snr(x,y);
输入滤波前x与滤波后y，返回SNR,和RMSE;
%*******************************************************************************************************%
其他功能实现主要在主程序中完成，详见程序注释，部分功能实现调用了以上函数返回值。
程序设计有很多疏漏和不足，望广大学友批评指正，交流学习，联系方式qq:2287744235.